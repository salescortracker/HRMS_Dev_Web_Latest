<div class="card shadow-sm p-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-semibold mb-0">
      <i class="fa-solid fa-certificate me-2 text-danger"></i> Employee Certifications
    </h4>
  </div>

  <hr />

  <!-- Certification Form -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <form [formGroup]="certificateForm" (ngSubmit)="saveCertification()" class="form-row" style="display: flex; flex-wrap: wrap; gap: 20px;">
        
        <!-- Certification Name -->
        <div class="form-group" style="flex: 1 1 calc(33.33% - 20px);">
          <label>Certification Name</label>
          <input type="text" formControlName="certificationName" class="form-control" placeholder="Enter certification name" required />
        </div>

        <!-- Certification Type -->
        <div class="form-group" style="flex: 1 1 calc(33.33% - 20px);">
          <label>Certification Type</label>
          <select formControlName="certificationType" class="form-select" required>
            <option value="">Select Type</option>
            <option *ngFor="let type of certificationTypeList" [value]="type.certificationTypeName">
              {{ type.certificationTypeName }}
            </option>
          </select>
        </div>

        <!-- Description -->
        <div class="form-group" style="flex: 1 1 calc(33.33% - 20px);">
          <label>Description</label>
          <textarea formControlName="description" class="form-control" placeholder="Enter description" rows="1"></textarea>
        </div>

        <!-- File Upload -->
        <div class="form-group" style="flex: 1 1 calc(33.33% - 20px);">
          <label>Upload Documents</label>
          <input type="file" (change)="onFileSelected($event)" class="form-control" />
        </div>

        <!-- Submit / Reset Buttons -->
        <div class="form-group" style="flex: 1 1 100%; text-align: right;">
          <button type="submit" class="btn btn-dark">
            {{ isEditMode ? 'Update Certification' : 'Add Certification' }}
          </button>
          <button type="button" class="btn btn-secondary ms-2" (click)="resetForm()">Reset</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Search -->
  <div class="mb-3 row g-3 align-items-end">
    <div class="col-md-4">
      <input type="text" class="form-control" placeholder="Search by Certification Name" [(ngModel)]="searchText" (ngModelChange)="onFilterChange()" />
    </div>
  </div>

  <!-- Certification Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>S.No</th>
          <th (click)="sortBy('certificationName')" style="cursor:pointer">
            Certification Name <span *ngIf="sortColumn === 'certificationName'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          </th>
          <th (click)="sortBy('certificationType')" style="cursor:pointer">
            Type <span *ngIf="sortColumn === 'certificationType'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          </th>
          <th>Description</th>
          <th>Document</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cert of filteredCertifications(); let i = index">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ cert.certificationName }}</td>
          <td>{{ cert.certificationType }}</td>
          <td>{{ cert.description }}</td>
             <td><a *ngIf="cert.documentPath" (click)="viewDocument(cert.documentPath)"  style="cursor:pointer; color: #0d6efd; font-weight: 500;"> View</a></td>
          <td class="text-center">
            <i class="fa-solid fa-pen me-2" (click)="editCertification(cert)"></i>
            <i class="fa-solid fa-trash" (click)="deleteCertification(cert.certificationId)"></i>
          </td>
        </tr>
        <tr *ngIf="filteredCertifications().length === 0">
          <td colspan="6" class="text-center text-muted">No records found</td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="d-flex justify-content-between align-items-center mt-3">
      <div>
        <label>Show:
          <select class="form-select d-inline w-auto ms-2" [(ngModel)]="pageSize" (change)="changePageSize(pageSize)">
            <option *ngFor="let size of pageSizeOptions" [ngValue]="size">{{ size }}</option>
          </select>
          entries
        </label>
      </div>
      <div>
        <button class="btn btn-outline-secondary btn-sm me-2" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
        <span>Page {{ currentPage }} of {{ totalPages }}</span>
        <button class="btn btn-outline-secondary btn-sm ms-2" (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">Next</button>
      </div>
    </div>
  </div>
</div>
