<app-header></app-header>
<app-sidebar></app-sidebar>

<div class="dashboard-header">
  <h2 class="dashboard-title">Leave Management</h2>
  <nav class="breadcrumb">
    <a href="#">Home</a> &gt;
    <a href="#">Leave</a> &gt;
    <span>Leave Management</span>
  </nav>
</div>

<div class="tab-container mt-4">

  <!-- TAB RADIO BUTTONS -->
  <input type="radio" id="tab1" name="tab" checked>
  <input type="radio" id="tab2" name="tab">
  <input type="radio" id="tab3" name="tab">

  <!-- TAB HEADERS -->
  <div class="tab-header">
    <label for="tab1" class="tab-label">Apply Leave</label>
    <label for="tab2" class="tab-label">Leave Approvals</label>
    <label for="tab3" class="tab-label">Leave Calendar</label>
  </div>

  <!-- ========================= APPLY LEAVE TAB ========================= -->
  <div class="tab-content" id="content1">
    <div class="card p-4 shadow-sm">
      <h5 class="mb-3">Apply for Leave</h5>

      <!-- Apply Leave Form -->
      <form>
        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">Leave Type <span class="text-danger">*</span></label>
            <select class="form-select" required>
              <option value="">Select leave type</option>
              <option>Sick Leave</option>
              <option>Casual Leave</option>
              <option>Paid Leave</option>
              <option>Maternity Leave</option>
              <option>Paternity Leave</option>
              <option>Other</option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label">Start Date <span class="text-danger">*</span></label>
            <input type="date" class="form-control" required>
          </div>

          <div class="col-md-4">
            <label class="form-label">End Date <span class="text-danger">*</span></label>
            <input type="date" class="form-control" required>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">Total Days</label>
            <input type="number" class="form-control" readonly placeholder="Total leave days">
          </div>

          <div class="col-md-4">
            <label class="form-label">Reason / Remarks</label>
            <textarea class="form-control" rows="2" placeholder="Enter reason for leave"></textarea>
          </div>

          <div class="col-md-4">
            <label class="form-label">Supporting Document</label>
            <input type="file" class="form-control" accept=".pdf,.jpg,.png">
          </div>
        </div>

        <div class="text-start">
          <button type="submit" class="btn btn-primary">Submit Leave Request</button>
        </div>
      </form>
    </div>

    <!-- FILTER SECTION -->
    <div class="card p-3 shadow-sm mt-4">
      <h6 class="mb-3">Filter Leave Requests</h6>
      <div class="row g-2">
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="Search by Leave Type">
        </div>
        <div class="col-md-3">
          <input type="date" class="form-control" placeholder="From Date">
        </div>
        <div class="col-md-3">
          <input type="date" class="form-control" placeholder="To Date">
        </div>
        <div class="col-md-3">
          <button class="btn btn-outline-primary w-100">Filter</button>
        </div>
      </div>
    </div>

    <!-- LEAVE LIST -->
    <div class="card p-4 shadow-sm mt-4">
      <h5 class="mb-3">My Leave Requests</h5>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>Applied Date</th>
              <th>Leave Type</th>
              <th>From</th>
              <th>To</th>
              <th>Total Days</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>2025-10-14</td>
              <td>Casual Leave</td>
              <td>2025-10-16</td>
              <td>2025-10-17</td>
              <td>2</td>
              <td>Family Function</td>
              <td><span class="badge bg-warning text-dark">Pending</span></td>
              <td class="text-center">
                <a href="#" data-bs-toggle="modal" data-bs-target="#viewLeaveModal">
                  <i class="fa-solid fa-eye text-primary"></i>
                </a>
              </td>
            </tr>
            <tr>
              <td>2025-09-20</td>
              <td>Sick Leave</td>
              <td>2025-09-22</td>
              <td>2025-09-23</td>
              <td>2</td>
              <td>Fever</td>
              <td><span class="badge bg-success">Approved</span></td>
              <td class="text-center">
                <a href="#" data-bs-toggle="modal" data-bs-target="#viewLeaveModal">
                  <i class="fa-solid fa-eye text-primary"></i>
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ========================= LEAVE APPROVALS TAB ========================= -->
  <div class="tab-content" id="content2">
    <div class="card p-4 shadow-sm">
      <h5 class="mb-3">Leave Approvals (Manager View)</h5>
      <div class="table-responsive">
        <table class="table table-bordered align-middle">
          <thead class="table-light">
            <tr>
              <th><input type="checkbox"></th>
              <th>Employee Name</th>
              <th>Leave Type</th>
              <th>From</th>
              <th>To</th>
              <th>Days</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><input type="checkbox"></td>
              <td>John Doe</td>
              <td>Paid Leave</td>
              <td>2025-10-20</td>
              <td>2025-10-22</td>
              <td>3</td>
              <td>Vacation</td>
              <td><span class="badge bg-warning text-dark">Pending</span></td>
              <td class="text-center">
                <a href="#" data-bs-toggle="modal" data-bs-target="#viewLeaveModal"><i class="fa-solid fa-eye text-primary"></i></a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mt-3 text-start">
        <button class="btn btn-success me-2">Approve Selected</button>
        <button class="btn btn-danger">Reject Selected</button>
      </div>
    </div>
  </div>

  <!-- ========================= LEAVE CALENDAR TAB ========================= -->
  <div class="tab-content" id="content3">
   <div class="calendar-container">

  <!-- Header -->
  <div class="calendar-header">
    <div>
      <button (click)="prevMonth()" *ngIf="selectedView==='month'">&lt;</button>
      <span>{{ currentYear }} - {{ (currentMonth + 1) | number:'2.0' }}</span>
      <button (click)="nextMonth()" *ngIf="selectedView==='month'">&gt;</button>
    </div>
    <div>
      <label>Employee:</label>
      <select [(ngModel)]="selectedEmployee">
        <option *ngFor="let emp of employees" [value]="emp">{{ emp }}</option>
      </select>
    </div>
    <div>
      <label>View:</label>
      <select [(ngModel)]="selectedView">
        <option value="month">Month</option>
        <option value="week">Week</option>
        <option value="day">Day</option>
      </select>
    </div>
  </div>

  <!-- Month View -->
  <div *ngIf="selectedView==='month'" class="month-view">
    <div class="day-name" *ngFor="let day of ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']">{{ day }}</div>
    <ng-container *ngFor="let week of weeks">
      <div class="day-cell" *ngFor="let day of week" [class.today]="isToday(day)" [class.leave]="hasLeave(day)">
        <div class="date">{{ day }}</div>
        <div class="leave">{{ hasLeave(day) }}</div>
      </div>
    </ng-container>
  </div>

  <!-- Week View -->
  <div *ngIf="selectedView==='week'" class="week-view">
    <div class="day-cell" *ngFor="let d of getWeekDates(currentDate)">
      <div class="day-name">{{ d.day }}</div>
      <div class="date">{{ d.dateStr.split('-')[2] }}</div>
      <div class="leave" *ngFor="let l of getDayLeaves(d.dateStr)">{{ l.type }}</div>
    </div>
  </div>

  <!-- Day View -->
  <div *ngIf="selectedView==='day'" class="day-view">
    <h3>{{ currentDate | date:'fullDate' }}</h3>
    <ul>
      <li *ngFor="let l of getDayLeaves(currentDate | date:'yyyy-MM-dd')">{{ l.type }}</li>
      <li *ngIf="getDayLeaves(currentDate | date:'yyyy-MM-dd').length===0">No leaves</li>
    </ul>
  </div>
</div>

  </div>
</div>

<!-- VIEW LEAVE MODAL -->
<div class="modal fade" id="viewLeaveModal" tabindex="-1" aria-labelledby="viewLeaveModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="viewLeaveModalLabel">Leave Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p><strong>Employee:</strong> John Doe</p>
        <p><strong>Leave Type:</strong> Casual Leave</p>
        <p><strong>Duration:</strong> 2 Days (2025-10-16 to 2025-10-17)</p>
        <p><strong>Reason:</strong> Family Function</p>
        <p><strong>Status:</strong> Pending</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success">Approve</button>
        <button class="btn btn-danger">Reject</button>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
